# Developer Guide: Interactive Philippine Map

This document outlines a design guideline for your interactive Philippine map web application, focusing on modularity and scalability.

### **1. Project Structure**

To keep your code organized and scalable, I recommend the following file structure within the `src` directory:

```
src/
├───data/
│   ├───ph.json             # GeoJSON for the map
│   └───region_data.json    # Sample data for regions (e.g., population, etc.)
├───js/
│   ├───map.js              # Your existing map initialization
│   ├───filter.js           # (New) Logic for the filter panel
│   ├───infoPanel.js        # (New) Logic for the text box panel
│   └───script.js           # Main script to connect everything
└───styles/
    └───style.css           # Main styles for your layout and components
```

### **2. HTML (`index.html`)**

Your HTML body can be structured with simple `div` containers for each main component.

```html
<body>
    <div id="app">
        <div id="map-container">
            <div id="map"></div>
        </div>
        <div id="filter-panel" class="panel">
            <!-- Filter controls will be generated by filter.js -->
        </div>
        <div id="info-panel" class="panel" style="display: none;">
            <!-- Content will be generated by infoPanel.js -->
        </div>
    </div>
    <script src="https://unpkg.com/maplibre-gl@4.1.0/dist/maplibre-gl.js"></script>
    <script type="module" src="src/js/script.js"></script>
</body>
```

### **3. CSS (`src/styles/style.css`)**

Use a modern layout like CSS Grid or Flexbox to position your components. Here’s a simple example using Flexbox to place the panels over the map.

```css
body {
    margin: 0;
    font-family: sans-serif;
}

#app {
    display: flex;
    position: relative;
    height: 100vh;
}

#map-container {
    flex-grow: 1;
}

#map {
    width: 100%;
    height: 100%;
}

.panel {
    position: absolute;
    top: 20px;
    background: white;
    padding: 15px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    z-index: 1;
    max-height: 90vh;
    overflow-y: auto;
}

#filter-panel {
    left: 20px;
}

#info-panel {
    right: 20px;
}
```

### **4. JavaScript Modules (`src/js/`)**

This is how the JavaScript modules would work together:

**`script.js` (The Conductor)**

This file imports all other modules and makes them work together.

*   **Responsibility:**
    1.  Initialize the map.
    2.  Load the regional data.
    3.  Initialize the filter panel with the loaded data.
    4.  Listen for events (e.g., a filter change from `filter.js` or a region click from `map.js`).
    5.  When an event occurs, update the map's appearance and show/hide/update the `infoPanel`.

**`map.js` (The Map)**

*   **Responsibility:**
    1.  Initialize and configure the MapLibre instance (as you've done).
    2.  (New) Add functions to interact with the map, like changing the color of a region or adding a click listener. For example:
        ```javascript
        // In map.js, you could add a function like this
        export function setRegionColor(regionId, color) {
            map.setPaintProperty(regionId, 'fill-color', color);
        }
        ```

**`filter.js` (The Controls)**

*   **Responsibility:**
    1.  Fetch and render the filter options (e.g., from a JSON file).
    2.  Create the UI for the filters (e.g., checkboxes, dropdowns).
    3.  When a user interacts with a filter, it notifies `script.js` about the change. You can use custom events for this.

**`infoPanel.js` (The Details)**

*   **Responsibility:**
    1.  Provide simple functions to control the panel.
    2.  It should not know *why* it's being shown, only *what* to display.
        ```javascript
        // In infoPanel.js
        const panel = document.getElementById('info-panel');

        export function show(content) {
            panel.innerHTML = content;
            panel.style.display = 'block';
        }

        export function hide() {
            panel.style.display = 'none';
        }
        ```

This design keeps each part of your application separate and focused on a single job, which will make it much easier to manage and expand in the future.

### **5. Interaction Example: Clicking a Region**

Here’s how the modules would work together when a user clicks on a region to see more information:

1.  **The User Clicks a Region on the Map.**

2.  **`map.js` Handles the Click and Notifies Others.**
    *   It listens for a `click` event on the map's region layer.
    *   Instead of directly showing an info box, it dispatches a custom event (e.g., `regionClick`) to announce that a region was clicked. This keeps the map module decoupled from the info panel.

    ```javascript
    // In map.js, inside your map initialization
    map.on('click', 'your-region-layer-name', (e) => {
        const regionId = e.features[0].properties.ID; // Or however you get the ID
        const event = new CustomEvent('regionClick', { detail: { regionId } });
        map.getCanvas().dispatchEvent(event);
    });
    ```

3.  **`script.js` Orchestrates the Response.**
    *   It listens for the `regionClick` event.
    *   When the event is caught, it finds the corresponding data for the clicked region.
    *   It then calls the `show()` function from `infoPanel.js` with the data.

    ```javascript
    // In script.js
    import { show as showInfoPanel } from './infoPanel.js';

    // ... after data is loaded ...
    const mapCanvas = map.getCanvas();
    mapCanvas.addEventListener('regionClick', (e) => {
        const { regionId } = e.detail;
        const regionData = allData.find(r => r.id === regionId);

        if (regionData) {
            const content = `<h3>${regionData.name}</h3><p>Details about the region...</p>`;
            showInfoPanel(content);
        }
    });
    ```

4.  **`infoPanel.js` Displays the Information.**
    *   The `show()` function in `infoPanel.js` receives the HTML content and updates the panel, making it visible.

This event-based approach ensures that your `map.js` doesn't need to know about the info panel, and the `infoPanel.js` doesn't need to know about the map. `script.js` acts as the central coordinator.